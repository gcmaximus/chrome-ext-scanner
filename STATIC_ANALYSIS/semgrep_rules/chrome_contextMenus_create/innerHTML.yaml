rules:
- id: chrome_contextMenus_create-innerHTML
  languages:
    - javascript
  message: Source:chrome.contextMenus.create;Sink:innerHTML
  mode: taint
  pattern-sources:
    - pattern: |
        function $FUNC(...) {...}
          ...
        chrome.contextMenus.create({
          onclick: $FUNC
        },...)
    - pattern: |
        chrome.contextMenus.create({
          onclick: $FUNC
        },...)
        ...
        function $FUNC(...) {...}
    - pattern: |
        chrome.contextMenus.create({
          onclick: function(...) {...}
        },...)
    - pattern: |
        chrome.contextMenus.create({
          onclick: function $FUNC(...) {...}
        },...)
    - pattern: |
        chrome.contextMenus.create({
          onclick: function $FUNC(...) {...}
        },...)
  pattern-sinks:
    - pattern: $OBJ.innerHTML = <... $INFO.linkUrl ...>
    - pattern: $OBJ.innerHTML = <... $INFO.srcUrl ...>
    - pattern: $OBJ.innerHTML = <... $INFO.pageUrl ...>
    - pattern: $OBJ.innerHTML = <... $INFO.frameUrl ...>
    - pattern: $OBJ.innerHTML = <... $INFO.selectionText ...>
    - pattern: |
        $X = $INFO.linkUrl
        ...
        $OBJ.innerHTML = <... $X ...>
    - pattern: |
        $X = $INFO.srcUrl
        ...
        $OBJ.innerHTML = <... $X ...>
    - pattern: |
        $X = $INFO.pageUrl
        ...
        $OBJ.innerHTML = <... $X ...>
    - pattern: |
        $X = $INFO.frameUrl
        ...
        $OBJ.innerHTML = <... $X ...>
    - pattern: |
        $X = $INFO.selectionText
        ...
        $OBJ.innerHTML = <... $X ...>
  severity: WARNING
