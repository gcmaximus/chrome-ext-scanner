rules:
  - id: 20a-innerHTML
    message: "Source:chrome.contextMenus.create;Sink:innerHTML"
    languages:
      - javascript
    pattern-either:
      - patterns:
        - pattern-inside: |
            chrome.contextMenus.create({
              onclick: function($INFO, ...){
                ...
            }},...)
        - pattern-either: 
            - pattern: |
                $OBJ.innerHTML = <... $INFO.linkUrl ...>
            - pattern: |
                $X = $INFO.linkUrl
                ...
                $OBJ.innerHTML = <... $X ...>
      - patterns:
        - pattern-inside: |
            chrome.contextMenus.create({
              onclick: function($INFO, ...){
                ...
            }},...)
        - pattern-either: 
            - pattern: |
                $OBJ.innerHTML = <... $INFO.srcUrl ...>
            - pattern: |
                $X = $INFO.srcUrl
                ...
                $OBJ.innerHTML = <... $X ...>
      - patterns:
        - pattern-inside: |
            chrome.contextMenus.create({
              onclick: function($INFO, ...){
                ...
            }},...)
        - pattern-either: 
            - pattern: |
                $OBJ.innerHTML = <... $INFO.pageUrl ...>
            - pattern: |
                $X = $INFO.pageUrl
                ...
                $OBJ.innerHTML = <... $X ...>
      - patterns:
        - pattern-inside: |
            chrome.contextMenus.create({
              onclick: function($INFO, ...){
                ...
            }},...)
        - pattern-either: 
            - pattern: |
                $OBJ.innerHTML = <... $INFO.frameUrl ...>
            - pattern: |
                $X = $INFO.frameUrl
                ...
                $OBJ.innerHTML = <... $X ...>
      - patterns:
        - pattern-inside: |
            chrome.contextMenus.create({
              onclick: function($INFO, ...){
                ...
            }},...)
        - pattern-either: 
            - pattern: |
                $OBJ.innerHTML = <... $INFO.selectionText ...>
            - pattern: |
                $X = $INFO.selectionText
                ...
                $OBJ.innerHTML = <... $X ...>
    severity: WARNING
