rules:
  - id: 3a-innerHTML
    languages:
      - javascript
    pattern-either:
      - pattern: |
          location.href
      - pattern: |
          $X = location.href
          ...
          $OBJECT.innerHTML = $X
      - pattern: |
          $X = location.href
          ...
          function $FUNC(...,$ARG,...) {
            ...
            $OBJECT.innerHTML = $ARG
            ...
          }
          ...
          $FUNC(...,$X,...)
    message: Source:location.href;Sink:innerHTML
    severity: WARNING